<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harden First, Patch Less: The Economics of Secure CI/CD - Samuel Aydlette</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/articles.css">
</head>
<body>
    <header class="header">
        <h1>Sam Aydlette</h1>
        <p>Author and Cybersecurity Practitioner</p>
    </header>

    <div class="main-container">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="navbar-header">
                <h1><a href="/index.html" style="text-decoration: none; color: inherit;">Sam Aydlette</a></h1>
                <p>Author and Cybersecurity Practitioner</p>
            </div>
            <div class="nav-grid">
                <a href="/pages/books.html" class="nav-button">Books</a>
                <a href="/pages/articles.html" class="nav-button">Articles</a>
                <a href="/pages/about.html" class="nav-button">About</a>
                <a href="/pages/contact.html" class="nav-button">Contact</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <article class="article-card">
                <div class="article-meta">
                    <span class="article-date">April 28, 2025</span>
                    <span class="article-category">Cloud Security</span>
                </div>
                
                <h2 class="article-title">Harden First, Patch Less: The Economics of Secure CI/CD</h2>
                
                <div class="article-content">
                    <div class="disclaimer">
                        The views and opinions expressed in this article are those of the author and do not reflect the views of any organization or employer.
                    </div>
                    <div class="article-summary">
                        <p>Security isn't the only reason to invest in secure CI/CD. Cloud service providers can also lower overall operating costs and unlock opportunities in multiple regulated markets by centrally ensuring that what is deployed into production is already secure.</p>
                    </div>

                    <h3>The Foundation of Secure CI/CD: Hardened Components</h3>
                    <p>Investing in a secure CI/CD pipeline is like hiring a skilled maître d' at a trendy restaurant. To the untrained eye, the maître d' is just walking around and talking to people. Why invest in that when you can focus on the food, the decor, or the wait staff? But successful restaurateurs understand that the maître d' seamlessly preserves the mystique of exclusivity with streamlined efficiency, which is the key to a restaurant’s success in competitive (and lucrative) environments. Similarly, having a CI/CD pipeline that enforces the use of security gates and hardened components is like having a skilled  maître d' for your deployments - very selective of who gets in and unimpressed by excuses about why some sketchy package should be on the list. Everything is seamlessly secure and "discerning clientele" (i.e., your customers CIO) certainly appreciate that.</p>
                    
                    <p>Why does selectivity matter for your cloud deployments? General purpose images typically include unnecessary services, open ports and default credentials. Using general purpose images is especially risky because supply chain attacks are increasing. Sophisticated threat actors aren't just targeting your perimeter anymore, they're targeting your software vendors to create a master key to every door before you even install them. Ensuring adequate provenance and integrity of your components is no longer optional. Simply put, organizations that aren’t hardening will get breached, if they haven’t been already. The 2024 Sophos State of ransomware report indicated that organizations with unpatched vulnerabilities were 2.8 times more likely to experience ransomware. And considering that almost 60% of organizations reported being ransomwared in 2024 (and many more went unreported) well… you do the math.</p>

                    <p>Due to this heightened threat landscape, maintaining a continuous inventory of hardened components has become the foundation that <em>all</em> compliance frameworks are rapidly moving towards these days. You can't patch once a quarter and expect to squeak through an audit for much longer. Ignore this at your peril, unless you enjoy explaining audit findings to executives who suddenly develop an intense interest in the technical details of your "SSH into EC2 and then run bash scripts" approach to code deployments.</p>

                    <p>By using hardened cloud components, organizations can eliminate vulnerabilities before deployment rather than frantically patching systems on live production hosts while praying that nothing breaks too badly. Integrating security into CI/CD also provides organizations with the flexibility to more easily modularize their cloud model to enter different regulated markets using the same hardened tech stack across multiple compliance requirements and sovereign geographic locations.</p>

                    <h3>How to Implement Hardening</h3>
                    <p>Organizations seeking to implement hardened components in their cloud environments have two options: building an internal hardening process (the "we own the pain" approach) or leveraging pre-hardened images from specialized vendors (the "please take my money and make this problem go away" approach).</p>

                    <h4>Option 1: DIY Hardening</h4>
                    <p>Hardening objectives are often based on established frameworks like Security Technical Implementation Guides (STIGs) developed by the Defense Information Systems Agency (DISA). STIGs are meant to apply to your entire stack and many options exist for operating systems, databases, applications and network devices.</p>

                    <p>Applying STIGs typically involves a four-step process that combines bureaucracy, technical challenges, and existential dread:</p>
                    <ol>
                        <li><strong>Baseline creation</strong>: Developing hardened base images for each component you are deploying.</li>
                        <li><strong>Automated configuration management</strong>: Using configuration management and validation tools to maintain consistency.</li>
                        <li><strong>Deviation management</strong>: Creating exceptions where you either accept or lower the risk of not applying a specific hardening rule.</li>
                        <li><strong>Continuous monitoring</strong>: Constantly verifying that nobody has quietly disabled all your security controls when you weren't looking.</li>
                    </ol>

                    <p>While effective in theory, this approach comes with its share of challenges.</p>
                    <ul>
                        <li><strong>Resource intensive</strong>: Every time new vendor patches are released or STIGs are updated, a new build is required. This ongoing process of building images to strip unneeded functionality and remove CVEs is resource intensive.</li>
                        <li><strong>Expertise requirements</strong>: Organizations need specialized knowledge across multiple technologies, and these unicorn employees are hard to find and even harder to retain.</li>
                        <li><strong>Management overhead</strong>: Hardened components must be thoroughly tested to ensure they don't break application functionality. The more complex the tech stack becomes, the more dependencies become increasingly unwieldy.</li>
                    </ul>

                    <p>Generally speaking, only the largest or most advanced organizations have the expertise and the economy of scale necessary to make "in house" component hardening worth it. Even then, it's hard to pull off. For everyone else, it's probably better to pay someone to do it for you.</p>

                    <h4>Option 2: Buying Pre-Hardened Images from Specialized Vendors</h4>
                    <p>The alternative approach is leveraging pre-hardened images from specialized vendors, who provide components specifically designed with security as a primary focus. This is the "I have money and would prefer to keep my sanity" solution.</p>
                    <p>While likely less expensive than doing everything yourself, buying pre-hardened images from a vendor is not cheap, and there are still additional costs. These include:</p>
                    <ul>
                        <li><strong>Licensing costs</strong>: Subscription fees based on deployment scale</li>
                        <li><strong>Integration expenses</strong>: Resources required to incorporate hardened images into existing pipelines</li>
                        <li><strong>Training requirements</strong>: Staff may need training on new tooling</li>
                        <li><strong>Support costs</strong>: Enterprise support agreements for when things inevitably break at 3 AM on a holiday weekend</li>
                    </ul>
                    
                    <p>Relying on a 3rd party vendor for hardened images also means that you are adding risk to your supply chain. A vendor may go out of business suddenly or get acquired and decide to stop supporting the images you use. If this happens, you may have to quickly migrate off of the purchased images en masse, which is risky.</p>

                    <p>Point being, there are substantial costs either way. If I figure out how to make money without investing any, I'll probably stop writing these articles. However, buying pre-hardened images from a quality vendor provides a number of advantages:</p>

                    <ul>
                        <li><strong>Broad ecosystem support</strong>: Vendors typically provide hardened versions of popular components (NGINX, Redis, PostgreSQL, etc.) faster than your team could possibly harden them all</li>
                        <li><strong>Cloud provider integration</strong>: Pre-built solutions for major cloud platforms that work (almost) perfectly out of the box</li>
                        <li><strong>Customization options</strong>: Ability to tailor hardened images to specific requirements</li>
                        <li><strong>Deployment flexibility</strong>: Support for various environmental needs, from VMs to containers to whatever new deployment paradigm emerges next week</li>
                    </ul>

                    <h3>The Compounding Benefits of Deploying Hardened Components</h3>
                    <p>Regardless of implementation approach, hardened components deliver significant security advantages for cloud environments.</p>

                    <h4>Minimal CVEs and Faster Detection and Response</h4>
                    <p>Hardened components dramatically reduce the number of potential vulnerabilities by:</p>
                    <ul>
                        <li><strong>Eliminating unnecessary packages</strong>: Removing software that isn't required but is just there, such as development tools, documentation files, or unused language runtimes</li>
                        <li><strong>Configuring secure defaults</strong>: Because default settings are typically about as secure as using "password" as your password</li>
                        <li><strong>Regular updates</strong>: Maintained images receive security patches promptly, instead of sitting in your "I'll get to it later" queue for six months</li>
                    </ul>

                    <p>This approach improves security metrics across the board:</p>
                    <ul>
                        <li><strong>Faster Mean Time to Detection (MTTD)</strong>: With fewer components to monitor, security teams can identify issues faster</li>
                        <li><strong>Faster Mean Time to Remediation (MTTR)</strong>: Standardized environments make patching and updates more straightforward</li>
                        <li><strong>Overall risk posture improvement</strong>: The attack surface is reduced so significantly you might actually get to sleep through the night occasionally</li>
                    </ul>

                    <h4>Multi-Cloud Inventory of Hardened Components</h4>
                    <p>Package URL (PURL) has emerged as a crucial standard for component identification across diverse ecosystems. As a precise, decentralized identification method, PURL offers significant advantages, bringing order to chaos like a particularly effective librarian. The best part of using PURL is that it works across any tech stack or cloud infrastructure - you can deploy hardened images and identify them with PURL regardless of whether they are running in AWS, Azure, GCP or on-premise:</p>
                    <ul>
                        <li><strong>Unambiguous identification</strong>: Each component is uniquely identifiable regardless of source or repository, eliminating the "which version is this again?" problem</li>
                        <li><strong>Cross-platform consistency</strong>: Works the same across languages, package managers, and deployment models</li>
                        <li><strong>Automation support</strong>: Enables automated inventory tracking and vulnerability correlation</li>
                        <li><strong>Supply chain transparency</strong>: Facilitates clear tracking of component origins and dependencies</li>
                    </ul>

                    <p>Organizations leveraging PURL can maintain accurate inventories of all deployed components across complex tech stacks, enabling rapid identification of affected systems when new vulnerabilities emerge. Below is an example of a PURL for a specific PostgreSQL image:</p>
                    <div class="code-block">
                        <code>pkg:docker/postgres@14.5-alpine</code>
                    </div>

                    <h4>Supply Chain Security with Build-Time SBOMs</h4>
                    <p>Software Bills of Materials (SBOMs) are another essential artifact for demonstrating security, the "list of ingredients" that lets you proudly show your customers what exactly they are consuming on an ongoing basis. Generating built-time SBOMs from hardened components facilitates:</p>
                    <ul>
                        <li><strong>Comprehensive dependency visibility</strong>: Clear documentation of all included software, including the dependencies of dependencies of dependencies</li>
                        <li><strong>Provenance verification</strong>: Evidence of component origins and build processes</li>
                        <li><strong>Automated policy enforcement</strong>: SBOMs enable automated checks against security policies, catching violations before they make it into production</li>
                        <li><strong>Compliance documentation</strong>: Ready evidence for regulatory requirements, saving you from panic-generating documentation the night before an audit</li>
                    </ul>

                    <p>Build-time SBOM generation ensures that security is integrated from the earliest stages of deployment rather than being assessed retroactively.</p>

                    <h4>Build Integrity with SLSA Framework</h4>
                    <p>Supply chain Levels for Software Artifacts (SLSA, pronounced "salsa") is a framework that provides a “chain of custody” demonstrating that your deployment hasn't been tampered with. SLSA offers a security framework with progressive levels of maturity. Organizations implementing SLSA alongside hardened components gain significant advantages:</p>
                    <ul>
                        <li><strong>Build provenance</strong>: Cryptographically verifiable records of how, when, and where your components were built</li>
                        <li><strong>Chain of custody</strong>: Complete visibility into every handoff in your pipeline, ensuring nothing suspicious happened between source code and deployment</li>
                        <li><strong>Automated verification</strong>: Integration into CI/CD to automatically reject components that don't meet your required SLSA level</li>
                        <li><strong>Progressive security maturity</strong>: The ability to start simply and gradually increase your security posture in measurable increments</li>
                    </ul>
                    <p>Here's an example of SLSA provenance data for the hardened component that we identified with PURL earlier:</p>
                    <div class="code-block">
                        <code>
{
  "buildType": "https://slsa.dev/provenance/v1",
  "builder": {"id": "https://github.com/slsa-framework/slsa-github-generator/.github/workflows/builder_go_slsa3.yml"},
  "materials": [
    {"uri": "pkg:docker/postgres@14.5-alpine", "digest": {"sha256": "a5fe7ff380ba22c9f55e5f8..."}}
  ]
}
                        </code>
                    </div>
                    
                    <h4>Bonus: Achieving Economies of Scale</h4>
                    
                    <p>Many cloud service providers leverage the same or similar sets of components. For example, many vendors likely use Alpine Linux container images, NGINX web servers, and MongoDB databases. These and similar sets of hardened components, or alternatives like Chainguard's Wolfi that offer similar functionality, may be offered as a consolidated product that takes advantage of maximized efficiency to lower overall cost to different groups within a broader organization and the cloud industry as a whole.</p>
                    

                    <h4>Putting It Together: Enforcing Security Outcomes with Infrastructure as Code</h4>
                    <p>Infrastructure as Code (IaC) serves as the mechanism that integrates hardened components, PURL tracking, SBOM documentation, and SLSA validation into a cohesive security posture. IaC enables automated policy enforcement throughout your software development lifecycle, ensuring that all components meet specific security outcomes before they reach production. Your CI/CD pipelines become security checkpoints, automatically rejecting builds that incorporate vulnerable components or lack proper provenance and attestation.</p>
                    <p>When hardened components are managed through IaC, your build environments maintain their integrity through immutable infrastructure principles. Each deployment uses pre-vetted, minimal-CVE images that remain consistent across environments, eliminating configuration drift and unauthorized modifications. The PURL identification system seamlessly integrates with this approach, creating a universal addressing scheme that uniquely identifies each component regardless of its source ecosystem. This standardized identification enables precise tracking across disparate environments and simplifies vulnerability correlation. SLSA is also applied directly in your deployment pipeline code. Each build generates cryptographically signed attestations that verify the integrity of your software supply chain, creating an unbroken chain of custody from source to deployment. This approach is complemented by automated SBOM generation, which documents all dependencies for every deployment artifact. The result is a comprehensive security framework where images must come from approved registries, contain verifiable documentation, include signed attestations, and pass vulnerability scans before deployment. This integrated approach creates a multiplicative security effect. Your CI/CD pipeline becomes an end-to-end trust model for your deployments, the ultimate maître d' for your production environment.​​​​​​​​​​​​​​​​</p>
                    <div class="conclusion">
                        <h3>Conclusion</h3>
                        <p>Deploying hardened components via secure CI/CD pipelines provides a strong foundation by minimizing vulnerabilities, reducing attack surfaces, and improving visibility across the environment.</p>

                        <p>Whether organizations choose to develop internal hardening processes or leverage specialized vendor solutions, integrating the use of hardened components into DevSecOps represents a strategic security investment that will also drive business outcomes. The resulting benefits - including reduced vulnerabilities, improved incident response, better inventory management, and enhanced supply chain security - position organizations to maintain robust cloud security postures even as threats continue to evolve. These security principles also make achieving and maintaining compliance easier, faster and cheaper, unlocking the potential for organizations to access regulated markets.</p>
                    </div>
                </div>
            </article>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Samuel Aydlette. All rights reserved.</p>
        <div class="social-links">
            <a href="https://www.linkedin.com/in/sa2/">LinkedIn</a>
        </div>
    </footer>
    <script type="module" src="/assets/js/main.js"></script>
</body>
</html>
