<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harden First, Patch Less - Samuel Aydlette</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/articles.css">
</head>
<body>
    <header class="header">
        <h1>Sam Aydlette</h1>
        <p>Author and Cybersecurity Practitioner</p>
    </header>

    <div class="main-container">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="navbar-header">
                <h1><a href="/index.html" style="text-decoration: none; color: inherit;">Sam Aydlette</a></h1>
                <p>Author and Cybersecurity Practitioner</p>
            </div>
            <div class="nav-grid">
                <a href="/pages/books.html" class="nav-button">Books</a>
                <a href="/pages/articles.html" class="nav-button">Articles</a>
                <a href="/pages/about.html" class="nav-button">About</a>
                <a href="/pages/contact.html" class="nav-button">Contact</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <article class="article-card">
                <div class="article-meta">
                    <span class="article-date">April 20, 2025</span>
                    <span class="article-category">Cloud Security</span>
                </div>
                
                <h2 class="article-title">Harden First, Patch Less: The Economics of Secure DevSecOps Pipelines</h2>
                
                <div class="article-content">
                    <div class="disclaimer">
                        The views and opinions expressed in this article are those of the author and do not reflect the views of any organization or employer.
                    </div>

                    <p>
                        Cloud service providers entering regulated markets should consider what NYC restaurateurs know. You won't get far without a skilled host. By focusing on cultivating an "upscale clientele," restaurant hosts preserve the exclusivity of hot nightlife locations. Similarly, having a CI/CD pipeline that enforces the use of hardened components is like having a skilled host for your deployments - very selective of who gets in and unimpressed by your excuses about why your sketchy package should be on the list. Cloud service providers can elevate their security, lower overall operating costs, and unlock opportunities in multiple regulated markets by ensuring that what is deployed into production is already secure.
                    </p>

                    <h3>Why Hardening Your Components is Necessary: The Big Picture</h3>
                    <p>General purpose images typically include unnecessary services, open ports and default credentials. Using general purpose images is especially risky because supply chain attacks are increasing. Sophisticated threat actors aren't just targeting your perimeter anymore, they're targeting your software vendors to create a master key to every door before you even install them. Ensuring adequate provenance and integrity of your components is no longer optional. Simply put, organizations that aren't hardening will get breached, if they haven't been already. The 2024 Sophos State of ransomware report indicated that organizations with unpatched vulnerabilities were 2.8 times more likely to experience ransomware.</p>

                    <p>Due to this heightened threat landscape, maintaining a continuous inventory of hardened components has become the foundation that <em>all</em> compliance frameworks are rapidly moving towards these days. You can't patch once a quarter and expect to squeak through an audit for much longer. Ignore this at your peril, unless you enjoy explaining audit findings to executives who suddenly develop an intense interest in the technical details of your "SSH into EC2 and then use Vim" approach to code deployments.</p>

                    <p>By using hardened cloud components, organizations can eliminate vulnerabilities before deployment rather than frantically patching systems retroactively. Integrating security into CI/CD also provides organizations with the flexibility to more easily modularize their cloud model to enter different regulated markets using the same hardened tech stack across multiple compliance requirements and sovereign geographic locations.</p>

                    <h3>How to Implement Hardening</h3>
                    <p>Organizations seeking to implement hardened components in their cloud environments have two options: building an internal hardening process (the "we enjoy pain" approach) or leveraging pre-hardened images from specialized vendors (the "please take my money and make this problem go away" approach).</p>

                    <h3>Option 1: DIY Hardening</h3>
                    <p>Hardening objectives are often based on established frameworks like Security Technical Implementation Guides (STIGs) developed by the Defense Information Systems Agency (DISA). STIGs are meant to apply to your entire stack and many options exist for operating systems, databases, applications and network devices.</p>

                    <p>Applying STIGs typically involves a four-step process that combines bureaucracy, technical challenges, and existential dread:</p>
                    <ol>
                        <li><strong>Baseline creation</strong>: Developing hardened base images for each component you are deploying.</li>
                        <li><strong>Automated configuration management</strong>: Using configuration management and validation tools to maintain consistency.</li>
                        <li><strong>Deviation management</strong>: Creating exceptions where you either accept or lower the risk of not applying a specific hardening rule.</li>
                        <li><strong>Continuous monitoring</strong>: Constantly verifying that nobody has quietly disabled all your security controls when you weren't looking.</li>
                    </ol>

                    <p>While effective in theory, this approach comes with its share of challenges.</p>
                    <ul>
                        <li><strong>Resource intensive</strong>: Every time new vendor patches are released or STIGs are updated, a new build is required. This ongoing process of building images to strip unneeded functionality and remove CVEs is resource intensive.</li>
                        <li><strong>Expertise requirements</strong>: Organizations need specialized knowledge across multiple technologies, and these unicorn employees are hard to find and retain.</li>
                        <li><strong>Management overhead</strong>: Hardened components must be thoroughly tested to ensure they don't break application functionality. The more complex the tech stack becomes, the more dependencies become increasingly unwieldy.</li>
                    </ul>

                    <p>Generally speaking, only the largest or most advanced organizations have the expertise and the economy of scale necessary to make "in house" component hardening worth it. Even then, it's hard to pull off. For everyone else, it's probably better to pay someone to do it for you.</p>

                    <h3>Option 2: Buying Pre-Hardened Images from Specialized Vendors</h3>
                    <p>The alternative approach is leveraging pre-hardened images from specialized vendors, who provide components specifically designed with security as a primary focus. This is the "I have money and would prefer to keep my sanity" solution.</p>

                    <h4>Cost Considerations</h4>
                    <p>While likely less expensive than doing everything yourself, buying pre-hardened images from a vendor is not cheap, and there are still additional costs. These include:</p>
                    <ul>
                        <li><strong>Licensing costs</strong>: Subscription fees based on deployment scale</li>
                        <li><strong>Integration expenses</strong>: Resources required to incorporate hardened images into existing pipelines</li>
                        <li><strong>Training requirements</strong>: Staff may need training on new tooling</li>
                        <li><strong>Support costs</strong>: Enterprise support agreements for when things inevitably break at 3 AM on a holiday weekend</li>
                    </ul>

                    <p>Point being, there are costs either way. If I figure out how to make money without investing any, I'll probably stop writing these articles. However, buying pre-hardened images from a quality vendor provides a number of advantages:</p>

                    <ul>
                        <li><strong>Broad ecosystem support</strong>: Vendors typically provide hardened versions of popular components (NGINX, Redis, PostgreSQL, etc.) faster than your team could possibly harden them all</li>
                        <li><strong>Cloud provider integration</strong>: Pre-built solutions for major cloud platforms that work (almost) perfectly out of the box</li>
                        <li><strong>Customization options</strong>: Ability to tailor hardened images to specific requirements</li>
                        <li><strong>Deployment flexibility</strong>: Support for various environmental needs, from VMs to containers to whatever new deployment paradigm emerges next week</li>
                    </ul>

                    <h3>The Compounding Benefits of Deploying Hardened Components</h3>
                    <p>Regardless of implementation approach, hardened components deliver significant security advantages for cloud environments.</p>

                    <h4>Minimal CVEs and Faster Detection and Response</h4>
                    <p>Hardened components dramatically reduce the number of potential vulnerabilities by:</p>
                    <ul>
                        <li><strong>Eliminating unnecessary packages</strong>: Removing software that isn't required but is just there, such as development tools, documentation files, or unused language runtimes</li>
                        <li><strong>Configuring secure defaults</strong>: Because default settings are typically about as secure as using "password" as your password</li>
                        <li><strong>Regular updates</strong>: Maintained images receive security patches promptly, instead of sitting in your "I'll get to it later" queue for six months</li>
                    </ul>

                    <p>This approach improves security metrics across the board:</p>
                    <ul>
                        <li><strong>Faster Mean Time to Detection (MTTD)</strong>: With fewer components to monitor, security teams can identify issues faster</li>
                        <li><strong>Faster Mean Time to Remediation (MTTR)</strong>: Standardized environments make patching and updates more straightforward</li>
                        <li><strong>Overall risk posture improvement</strong>: The attack surface is reduced so significantly you might actually get to sleep through the night occasionally</li>
                    </ul>

                    <h4>Multi-Cloud Inventory of Hardened Components</h4>
                    <p>Package URL (PURL) has emerged as a crucial standard for component identification across diverse ecosystems. As a precise, decentralized identification method, PURL offers significant advantages, bringing order to chaos like a particularly effective librarian. The best part of using PURL is that it works across any tech stack or cloud infrastructure - you can deploy hardened images and identify them with PURL regardless of whether they are running in AWS, Azure, GCP or on-premise:</p>
                    <ul>
                        <li><strong>Unambiguous identification</strong>: Each component is uniquely identifiable regardless of source or repository, eliminating the "which version is this again?" problem</li>
                        <li><strong>Cross-platform consistency</strong>: Works the same across languages, package managers, and deployment models</li>
                        <li><strong>Automation support</strong>: Enables automated inventory tracking and vulnerability correlation</li>
                        <li><strong>Supply chain transparency</strong>: Facilitates clear tracking of component origins and dependencies</li>
                    </ul>

                    <p>Organizations leveraging PURL can maintain accurate inventories of all deployed components across complex tech stacks, enabling rapid identification of affected systems when new vulnerabilities emerge. Below is an example of a PURL for a specific PostgreSQL image:</p>
                    <div class="code-block">
                        <code>pkg:docker/postgres@14.5-alpine</code>
                    </div>

                    <h4>Supply Chain Security with Build-Time SBOMs</h4>
                    <p>Software Bills of Materials (SBOMs) are another essential artifact for demonstrating security, the "list of ingredients" that lets you proudly show your customers what exactly they are consuming on an ongoing basis. Generating built-time SBOMs from hardened components facilitates:</p>
                    <ul>
                        <li><strong>Comprehensive dependency visibility</strong>: Clear documentation of all included software, including the dependencies of dependencies of dependencies</li>
                        <li><strong>Provenance verification</strong>: Evidence of component origins and build processes</li>
                        <li><strong>Automated policy enforcement</strong>: SBOMs enable automated checks against security policies, catching violations before they make it into production</li>
                        <li><strong>Compliance documentation</strong>: Ready evidence for regulatory requirements, saving you from panic-generating documentation the night before an audit</li>
                    </ul>

                    <p>Build-time SBOM generation ensures that security is integrated from the earliest stages of deployment rather than being assessed retroactively.</p>

                    <div class="conclusion">
                        <h3>Conclusion</h3>
                        <p>Using hardened components provides a strong foundation by minimizing vulnerabilities, reducing attack surfaces, and improving visibility across the environment.</p>

                        <p>Whether organizations choose to develop internal hardening processes or leverage specialized vendor solutions, the implementation of hardened components represents a strategic security investment that will also drive business outcomes. The resulting benefits - including reduced vulnerabilities, improved incident response, better inventory management, and enhanced supply chain security - position organizations to maintain robust cloud security postures even as threats continue to evolve. These security principles also make achieving and maintaining compliance easier, faster and cheaper, unlocking the potential for organizations to access regulated markets.</p>
                    </div>
                </div>
            </article>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Samuel Aydlette. All rights reserved.</p>
        <div class="social-links">
            <a href="https://www.linkedin.com/in/sa2/">LinkedIn</a>
        </div>
    </footer>
    <script type="module" src="/assets/js/main.js"></script>
</body>
</html>
